<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width,
				initial-scale=1.0">
	<title>Dashboard</title>
	<link rel="stylesheet" href="../static/styles.css">
</head>

<body>

	<!-- for header part -->
	<header>

		<div class="logosec">
			<div class="logo">Tech Brains</div>
			<img src="https://media.geeksforgeeks.org/wp-content/uploads/20221210182541/Untitled-design-(30).png"
				class="icn menuicn" id="menuicn" alt="menu-icon">
		</div>

		<div class="searchbar">
			<input type="text" placeholder="Search">
			<div class="searchbtn">
				<img src="https://media.geeksforgeeks.org/wp-content/uploads/20221210180758/Untitled-design-(28).png"
					class="icn srchicn" alt="search-icon">
			</div>
		</div>

		<div class="message">
			<div class="circle"></div>
			<img src="https://media.geeksforgeeks.org/wp-content/uploads/20221210183322/8.png" class="icn" alt="">
			<div class="dp">
				<img src="https://media.geeksforgeeks.org/wp-content/uploads/20221210180014/profile-removebg-preview.png"
					class="dpicn" alt="dp">
			</div>
		</div>

	</header>

	<div class="main-container">
		<div class="navcontainer">
			<nav class="nav">
				<div class="nav-upper-options">
					<div class="nav-option option1">
						<img src="https://media.geeksforgeeks.org/wp-content/uploads/20221210182148/Untitled-design-(29).png"
							class="nav-img" alt="dashboard">
						<h3> Dashboard</h3>
					</div>

					<div class="nav-option option6">
						<img src="https://media.geeksforgeeks.org/wp-content/uploads/20221210183320/4.png"
							class="nav-img" alt="settings">
						<h3> Settings</h3>
					</div>

					<div class="nav-option logout">
						<img src="https://media.geeksforgeeks.org/wp-content/uploads/20221210183321/7.png"
							class="nav-img" alt="logout">
						<h3>Logout</h3>
					</div>

				</div>
			</nav>
		</div>
		<div class="main">

			<div class="searchbar2">
				<input type="text" name="" id="" placeholder="Search">
				<div class="searchbtn">
					<img src="https://media.geeksforgeeks.org/wp-content/uploads/20221210180758/Untitled-design-(28).png"
						class="icn srchicn" alt="search-button">
				</div>
			</div>

			<div class="box-container">

				<div class="box box1">
					<div class="text">
						<h2 class="topic-heading">{{ co1 }}</h2>
						<h2 class="topic">Positive</h2>
					</div>

					<!-- <img src=
"https://media.geeksforgeeks.org/wp-content/uploads/20221210184645/Untitled-design-(31).png"
						alt="Views">
                         -->
					<div class="green-dot"></div>
				</div>

				<div class="box box2">
					<div class="text">
						<h2 class="topic-heading">{{ co2 }}</h2>
						<h2 class="topic">Neutral</h2>
					</div>

					<!-- <img src=
"https://media.geeksforgeeks.org/wp-content/uploads/20221210185030/14.png"
						alt="likes"> -->
					<div class="yellow-dot"></div>
				</div>

				<div class="box box3">
					<div class="text">
						<h2 class="topic-heading">{{ co3 }}</h2>
						<h2 class="topic">Negative</h2>
					</div>

					<!-- <img src=
"https://media.geeksforgeeks.org/wp-content/uploads/20221210184645/Untitled-design-(32).png"
						alt="comments"> -->
					<div class="red-dot"></div>
				</div>
			</div>

			<div class="report-container">
				<div class="report-header">
					<h1 class="recent-Articles">Recent Articles</h1>
					<button class="view">View All</button>
				</div>

				<!-- <div class="report-body">
					<div class="report-topic-heading">
						<h3 class="t-op">NEWS</h3>
						
						
						
                        <h3 class="t-op">LINK</h3>
					</div> -->
				<table id="emp-table">
					<thead>
						<th col-index=1>
							<h3 class="t-op">NEWS</h3>
						</th>
						<th col-index=2>
							<h3 class="t-op">TONALITY</h3>
							<select class="table-filter" onchange="filter_rows()">
								<option value="all"></option>
							</select>
						</th>

						<th col-index=3>
							<h3 class="t-op">DOMAIN</h3>
							<select class="table-filter" onchange="filter_rows()">
								<option value="all"></option>
							</select>
						</th>
						<th col-index=4>
							<h3 class="t-op">DATE/TIME</h3>
							<select class="table-filter" onchange="filter_rows()">
								<option value="all"></option>
							</select>
						</th>
						<th col-index=5>LINK</th>

					</thead>
					<!-- <div class="items">
						<div class="item1">
							<h3 class="t-op-nextlvl">Article 73</h3>
							<h3 class="t-op-nextlvl">Positive</h3>
							<h3 class="t-op-nextlvl">Finance</h3>
							<h3 class="t-op-nextlvl">11/11/11</h3>
                            <h3 class="t-op-nextlvl label-tag">Link</h3>
						</div>

						<div class="item1">
							<h3 class="t-op-nextlvl">Article 72</h3>
							<h3 class="t-op-nextlvl">Negative</h3>
							<h3 class="t-op-nextlvl">Education</h3>
							<h3 class="t-op-nextlvl">12/24/11</h3>
                            <h3 class="t-op-nextlvl label-tag">Link</h3>
						</div>

						<div class="item1">
							<h3 class="t-op-nextlvl">Article 71</h3>
							<h3 class="t-op-nextlvl">1.1k</h3>
							<h3 class="t-op-nextlvl">150</h3>
							<h3 class="t-op-nextlvl label-tag">Published</h3>
						</div>

						<div class="item1">
							<h3 class="t-op-nextlvl">Article 70</h3>
							<h3 class="t-op-nextlvl">1.2k</h3>
							<h3 class="t-op-nextlvl">420</h3>
							<h3 class="t-op-nextlvl label-tag">Published</h3>
						</div>

						<div class="item1">
							<h3 class="t-op-nextlvl">Article 69</h3>
							<h3 class="t-op-nextlvl">2.6k</h3>
							<h3 class="t-op-nextlvl">190</h3>
							<h3 class="t-op-nextlvl label-tag">Published</h3>
						</div>

						<div class="item1">
							<h3 class="t-op-nextlvl">Article 68</h3>
							<h3 class="t-op-nextlvl">1.9k</h3>
							<h3 class="t-op-nextlvl">390</h3>
							<h3 class="t-op-nextlvl label-tag">Published</h3>
						</div>

						<div class="item1">
							<h3 class="t-op-nextlvl">Article 67</h3>
							<h3 class="t-op-nextlvl">1.2k</h3>
							<h3 class="t-op-nextlvl">580</h3>
							<h3 class="t-op-nextlvl label-tag">Published</h3>
						</div>

						<div class="item1">
							<h3 class="t-op-nextlvl">Article 66</h3>
							<h3 class="t-op-nextlvl">3.6k</h3>
							<h3 class="t-op-nextlvl">160</h3>
							<h3 class="t-op-nextlvl label-tag">Published</h3>
						</div>

						<div class="item1">
							<h3 class="t-op-nextlvl">Article 65</h3>
							<h3 class="t-op-nextlvl">1.3k</h3>
							<h3 class="t-op-nextlvl">220</h3>
							<h3 class="t-op-nextlvl label-tag">Published</h3>
						</div>

					</div> -->
					<tbody>
						{% for news in newses%}
						<tr>
							{% for item in news %}
							<td>{{item}}</td>

							{% endfor %}
						</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>
	</div>

	<script>

		function toggleNav() {
			let menuicn = document.querySelector(".menuicn");
			let nav = document.querySelector(".navcontainer");

			menuicn.addEventListener("click", () => {
				nav.classList.toggle("navclose");
			});
		}
		var currentDate = new Date();
		var dateElement = document.getElementById("currentDate");
		dateElement.innerHTML = currentDate.toDateString();
		function getUniqueValuesFromColumn() {

			var unique_col_values_dict = {}

			allFilters = document.querySelectorAll(".table-filter")
			allFilters.forEach((filter_i) => {
				col_index = filter_i.parentElement.getAttribute("col-index");
				// alert(col_index)
				const rows = document.querySelectorAll("#emp-table > tbody > tr")

				rows.forEach((row) => {
					cell_value = row.querySelector("td:nth-child(" + col_index + ")").innerHTML;
					// if the col index is already present in the dict
					if (col_index in unique_col_values_dict) {

						// if the cell value is already present in the array
						if (unique_col_values_dict[col_index].includes(cell_value)) {
							// alert(cell_value + " is already present in the array : " + unique_col_values_dict[col_index])

						} else {
							unique_col_values_dict[col_index].push(cell_value)
							// alert("Array after adding the cell value : " + unique_col_values_dict[col_index])

						}


					} else {
						unique_col_values_dict[col_index] = new Array(cell_value)
					}
				});


			});


			updateSelectOptions(unique_col_values_dict)

		};

		// Add <option> tags to the desired columns based on the unique values

		function updateSelectOptions(unique_col_values_dict) {
			allFilters = document.querySelectorAll(".table-filter")

			allFilters.forEach((filter_i) => {
				col_index = filter_i.parentElement.getAttribute('col-index')

				unique_col_values_dict[col_index].forEach((i) => {
					filter_i.innerHTML = filter_i.innerHTML + `\n<option value="${i}">${i}</option>`
				});

			});
		};


		// Create filter_rows() function

		// filter_value_dict {2 : Value selected, 4:value, 5: value}

		function filter_rows() {
			allFilters = document.querySelectorAll(".table-filter")
			var filter_value_dict = {}

			allFilters.forEach((filter_i) => {
				col_index = filter_i.parentElement.getAttribute('col-index')

				value = filter_i.value
				if (value != "all") {
					filter_value_dict[col_index] = value;
				}
			});

			var col_cell_value_dict = {};

			const rows = document.querySelectorAll("#emp-table tbody tr");
			rows.forEach((row) => {
				var display_row = true;

				allFilters.forEach((filter_i) => {
					col_index = filter_i.parentElement.getAttribute('col-index')
					col_cell_value_dict[col_index] = row.querySelector("td:nth-child(" + col_index + ")").innerHTML
				})

				for (var col_i in filter_value_dict) {
					filter_value = filter_value_dict[col_i]
					row_cell_value = col_cell_value_dict[col_i]

					if (row_cell_value.indexOf(filter_value) == -1 && filter_value != "all") {
						display_row = false;
						break;
					}


				}

				if (display_row == true) {
					row.style.display = "table-row"

				} else {
					row.style.display = "none"

				}





			})

		}
		
		toggleNav()
		getUniqueValuesFromColumn()
	</script>
</body>

</html>